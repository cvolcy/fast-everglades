<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/Umbrella/css/w3.css">
    <link rel="stylesheet" href="/Umbrella/css/style.css">
    <link rel="manifest" href="/Umbrella/manifest.json">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Umbrella</title>
    <link rel="shortcut icon" href="/Umbrella/images/icons/icon-32x32.ico" type="image/x-icon">
    <meta name="description" content="Umbrella" />
    <meta name="theme-color" content="#3E4EB8">
</head>

<body>
    <div class="bgimg w3-display-container w3-animate-opacity w3-text-white">
        <div class="w3-display-topleft w3-padding-large w3-xlarge">
            Umbrella
        </div>
        <div class="w3-display-middle">
            <h1 class="w3-jumbo w3-animate-top">{{ Label }}</h1>
            <hr class="w3-border-grey" style="margin:auto;width:40%">
            <p class="w3-large w3-center">{{ Message }}</p>
        </div>
        <button id="btnA2HS" class="w3-button w3-teal" style="position: absolute;bottom: 5%;right: 5%;display: none;">Add To Home Screen</button>
        <div class="w3-display-bottomleft w3-padding-large">
            Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank" rel="noreferrer">w3.css</a> <br>
            Icon made by <a href="https://smashicons.com/" target="_blank" rel="noopener noreferrer">Smashicons</a> from www.flaticon.com 
        </div>
    </div>
    <script type="text/javascript">
        window.addEventListener('load', async e => {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/Umbrella/sw.js', { scope: './Umbrella' }).then(function(registration) {
                    // Registration was successful
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, function(err) {
                    // registration failed :(
                    console.log('ServiceWorker registration failed: ', err);
                });
            }

            window.addEventListener('beforeinstallprompt', (e) => {
                // Prevent Chrome 67 and earlier from automatically showing the prompt
                e.preventDefault();
                // Stash the event so it can be triggered later.
                let deferredPrompt = e;

                let btnAdd = document.querySelector('#btnA2HS');
                // Update UI notify the user they can add to home screen
                btnAdd.style.display = 'block';

                btnAdd.addEventListener('click', (e) => {
                    // hide our user interface that shows our A2HS button
                    btnAdd.style.display = 'none';
                    // Show the prompt
                    deferredPrompt.prompt();
                    // Wait for the user to respond to the prompt
                    deferredPrompt.userChoice
                        .then((choiceResult) => {
                            if (choiceResult.outcome === 'accepted') {
                                console.log('User accepted the A2HS prompt');
                            } else {
                                console.log('User dismissed the A2HS prompt');
                            }
                            deferredPrompt = null;
                        });
                });
            });
        });
    </script>
</body>

</html>